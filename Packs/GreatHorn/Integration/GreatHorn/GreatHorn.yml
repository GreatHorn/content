category: Email Gateway
commonfields:
  id: GreatHorn
  version: -1
configuration:
- defaultvalue: https://api.greathorn.com
  display: Base URL
  name: url
  required: true
  type: 0
- defaultvalue: v2
  display: API Version
  name: api_version
  required: true
  type: 0
- display: API Key
  name: apikey
  required: true
  type: 4
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
- additionalinfo: Whether to fetch phishing reports, quarantine release reuests, or
    both as incidents
  display: Fetch Type
  hidden: false
  name: fetch_type
  options:
  - phishing
  - quarantine
  - both
  required: false
  type: 15
description: The only cloud-native security platform that stops targeted social engineering
  and phishing attacks on cloud email platforms like Office 365 and G Suite.
display: GreatHorn
name: GreatHorn
script:
  commands:
  - arguments:
    - default: false
      description: GreatHorn eventId, multiple values supported via CSV
      isArray: false
      name: id
      required: true
      secret: false
    - auto: PREDEFINED
      default: true
      defaultValue: 'false'
      description: Whether or not to include full message headers in the War Room
        output.
      isArray: false
      name: includeheaders
      predefined:
      - 'true'
      - 'false'
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: 'false'
      description: Whether or not to show all links in the War Room output. When false
        only suspicious and malicious links will be returned to the War Room.
      isArray: false
      name: showalllinks
      predefined:
      - 'true'
      - 'false'
      required: false
      secret: false
    deprecated: false
    execution: false
    name: gh-get-message
    outputs:
    - contextPath: GreatHorn.Message.origin
      type: String
    - contextPath: GreatHorn.Message.status
      type: String
    - contextPath: GreatHorn.Message.xMailer
      type: Unknown
    - contextPath: GreatHorn.Message.links.resolvedUrl
      type: Unknown
    - contextPath: GreatHorn.Message.links.text
      type: String
    - contextPath: GreatHorn.Message.links.url
      type: String
    - contextPath: GreatHorn.Message.links.tags
      type: String
    - contextPath: GreatHorn.Message.sourcePath
      type: String
    - contextPath: GreatHorn.Message.ip
      type: String
    - contextPath: GreatHorn.Message.bodyOnlyWhitespace
      type: Number
    - contextPath: GreatHorn.Message.quarReleasedBy
      type: Unknown
    - contextPath: GreatHorn.Message.dmarc
      type: String
    - contextPath: GreatHorn.Message.collector
      type: Unknown
    - contextPath: GreatHorn.Message.dkim
      type: String
    - contextPath: GreatHorn.Message.spf
      type: String
    - contextPath: GreatHorn.Message.contentHash
      type: String
    - contextPath: GreatHorn.Message.workflow
      type: String
    - contextPath: GreatHorn.Message.targets
      type: String
    - contextPath: GreatHorn.Message.source
      type: String
    - contextPath: GreatHorn.Message.location
      type: String
    - contextPath: GreatHorn.Message.quarDeleted
      type: Unknown
    - contextPath: GreatHorn.Message.quarDeletedBy
      type: Unknown
    - contextPath: GreatHorn.Message.violations
      type: Number
    - contextPath: GreatHorn.Message.subject
      type: String
    - contextPath: GreatHorn.Message.xAuthResults
      type: Unknown
    - contextPath: GreatHorn.Message.returnPath
      type: String
    - contextPath: GreatHorn.Message.eventId
      type: Number
    - contextPath: GreatHorn.Message.quarDenied
      type: Unknown
    - contextPath: GreatHorn.Message.received
      type: String
    - contextPath: GreatHorn.Message.replyTo
      type: String
    - contextPath: GreatHorn.Message.timestamp
      type: Date
    - contextPath: GreatHorn.Message.quarReleased
      type: Unknown
    - contextPath: GreatHorn.Message.authenticationResults
      type: String
    - contextPath: GreatHorn.Message.quarantined
      type: Unknown
    - contextPath: GreatHorn.Message.flag
      type: Number
    - contextPath: GreatHorn.Message.homographScore
      type: Number
    - contextPath: GreatHorn.Message.remediation
      type: Unknown
    - contextPath: GreatHorn.Message.owlScore
      type: Number
    - contextPath: GreatHorn.Message.quarReleaseRequested
      type: Unknown
    - contextPath: GreatHorn.Message.anomalyScore
      type: Number
    - contextPath: GreatHorn.Message.quarExpired
      type: Unknown
    - contextPath: GreatHorn.Message.displayName
      type: String
    - contextPath: GreatHorn.Message.country
      type: String
    - contextPath: GreatHorn.Message.region
      type: String
    - contextPath: GreatHorn.Message.headers.received-spf
      type: String
    - contextPath: GreatHorn.Message.headers.return-path
      type: String
    - contextPath: GreatHorn.Message.headers.x-eoptenantattributedmessage
      type: String
    - contextPath: GreatHorn.Message.headers.x-csa-complaints
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-exchange-crosstenant-authsource
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-exchange-processed-by-bccfoldering
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-exchange-organization-messagedirectionality
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-exchange-organization-expirationstarttimereason
      type: String
    - contextPath: GreatHorn.Message.headers.subject
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-exchange-organization-expirationstarttime
      type: String
    - contextPath: GreatHorn.Message.headers.list-id
      type: String
    - contextPath: GreatHorn.Message.headers.from
      type: String
    - contextPath: GreatHorn.Message.headers.to
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-office365-filtering-correlation-id
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-exchange-transport-endtoendlatency
      type: Date
    - contextPath: GreatHorn.Message.headers.x-ms-exchange-organization-expirationintervalreason
      type: String
    - contextPath: GreatHorn.Message.headers.list-unsubscribe
      type: String
    - contextPath: GreatHorn.Message.headers.mime-version
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-exchange-organization-scl
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-oob-tlc-oobclassifiers
      type: String
    - contextPath: GreatHorn.Message.headers.authentication-results
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-exchange-organization-authas
      type: String
    - contextPath: GreatHorn.Message.headers.x-microsoft-antispam-mailbox-delivery
      type: String
    - contextPath: GreatHorn.Message.headers.x-microsoft-antispam
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-traffic  typediagnostic
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-exchange-transport-crosstenantheadersstamped
      type: String
    - contextPath: GreatHorn.Message.headers.dkim-signature
      type: String
    - contextPath: GreatHorn.Message.headers.x-sfmc-stack
      type: String
    - contextPath: GreatHorn.Message.headers.date
      type: String
    - contextPath: GreatHorn.Message.headers.reply-to
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-exchange-organization-network-message-id
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-exchange-organization-authsource
      type: String
    - contextPath: GreatHorn.Message.headers.received
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-exchange-crosstenant-originalarrivaltime
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-publictraffic  type
      type: String
    - contextPath: GreatHorn.Message.headers.sender
      type: String
    - contextPath: GreatHorn.Message.headers.x-job
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-exchange-crosstenant-id
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-exchange-organization-expirationinterval
      type: String
    - contextPath: GreatHorn.Message.headers.x-eopattributedmessage
      type: String
    - contextPath: GreatHorn.Message.headers.x-microsoft-antispam-message-info
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-exchange-crosstenant-authas
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-exchange-crosstenant-fromentityheader
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-exchange-crosstenant-network-message-id
      type: String
    - contextPath: GreatHorn.Message.headers.x-forefront-antispam-report
      type: String
    - contextPath: GreatHorn.Message.headers.message-id
      type: String
    - contextPath: GreatHorn.Message.headers.content-  type
      type: String
    - contextPath: GreatHorn.Message.messageId
      type: String
    - contextPath: GreatHorn.Message.authScore
      type: Number
    - contextPath: GreatHorn.Message.headers.x-msfbl
      type: String
    - contextPath: GreatHorn.Message.headers.content-transfer-encoding
      type: String
    - contextPath: GreatHorn.Message.headers.precedence
      type: Unknown
    - contextPath: GreatHorn.Message.headers.arc-seal
      type: Unknown
    - contextPath: GreatHorn.Message.headers.arc-authentication-results
      type: Unknown
    - contextPath: GreatHorn.Message.headers.arc-message-signature
      type: Unknown
    - contextPath: GreatHorn.Message.headers.x-received
      type: Unknown
    - contextPath: GreatHorn.Message.headers.to
      type: Unknown
    - contextPath: GreatHorn.Message.headers.x-unsubscribe-web
      type: Unknown
    - contextPath: GreatHorn.Message.headers.x-mailer
      type: Unknown
    - contextPath: GreatHorn.Message.headers.x-info
      type: Unknown
    - contextPath: GreatHorn.Message.headers.delivered-to
      type: Unknown
    - contextPath: GreatHorn.Message.headers.mime-version
      type: Unknown
    - contextPath: GreatHorn.Message.headers.x-tm-id
      type: Unknown
    - contextPath: GreatHorn.Message.headers.x-rpcampaign
      type: Unknown
    - contextPath: GreatHorn.Message.headers.x-google-smtp-source
      type: Unknown
    - contextPath: GreatHorn.Message.headers.content-type
      type: Unknown
  - arguments:
    - default: false
      description: The fields to include in the response. By default, all fields are
        returned.
      isArray: false
      name: fields
      required: false
      secret: false
    - default: false
      description: The criteria to use in filtering search results
      isArray: false
      name: filters
      required: false
      secret: false
    - default: false
      defaultValue: '10'
      description: The maximum number of entries to return per page of results. Default
        is 10; max is 200.
      isArray: false
      name: limit
      required: false
      secret: false
    - default: false
      description: The zero-based offset of the first item in the collection. Default
        is 0; max is 10000.
      isArray: false
      name: offset
      required: false
      secret: false
    - default: false
      defaultValue: eventId
      description: The field to use in sorting results. Default is eventId.
      isArray: false
      name: sort
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: desc
      description: Indicates if the sort direction is ascending or descending. Default
        is descending.
      isArray: false
      name: sortDir
      predefined:
      - desc
      - asc
      required: false
      secret: false
    deprecated: false
    execution: false
    name: gh-search-message
    outputs:
    - contextPath: GreatHorn.Message.origin
      type: String
    - contextPath: GreatHorn.Message.status
      type: String
    - contextPath: GreatHorn.Message.xMailer
      type: Unknown
    - contextPath: GreatHorn.Message.links.resolvedUrl
      type: Unknown
    - contextPath: GreatHorn.Message.links.text
      type: String
    - contextPath: GreatHorn.Message.links.url
      type: String
    - contextPath: GreatHorn.Message.links.tags
      type: String
    - contextPath: GreatHorn.Message.sourcePath
      type: String
    - contextPath: GreatHorn.Message.ip
      type: String
    - contextPath: GreatHorn.Message.bodyOnlyWhitespace
      type: Number
    - contextPath: GreatHorn.Message.quarReleasedBy
      type: Unknown
    - contextPath: GreatHorn.Message.dmarc
      type: String
    - contextPath: GreatHorn.Message.collector
      type: Unknown
    - contextPath: GreatHorn.Message.dkim
      type: String
    - contextPath: GreatHorn.Message.spf
      type: String
    - contextPath: GreatHorn.Message.contentHash
      type: String
    - contextPath: GreatHorn.Message.workflow
      type: String
    - contextPath: GreatHorn.Message.targets
      type: String
    - contextPath: GreatHorn.Message.source
      type: String
    - contextPath: GreatHorn.Message.location
      type: String
    - contextPath: GreatHorn.Message.quarDeleted
      type: Unknown
    - contextPath: GreatHorn.Message.quarDeletedBy
      type: Unknown
    - contextPath: GreatHorn.Message.violations
      type: Number
    - contextPath: GreatHorn.Message.subject
      type: String
    - contextPath: GreatHorn.Message.xAuthResults
      type: Unknown
    - contextPath: GreatHorn.Message.returnPath
      type: String
    - contextPath: GreatHorn.Message.eventId
      type: Number
    - contextPath: GreatHorn.Message.quarDenied
      type: Unknown
    - contextPath: GreatHorn.Message.received
      type: String
    - contextPath: GreatHorn.Message.replyTo
      type: String
    - contextPath: GreatHorn.Message.timestamp
      type: Date
    - contextPath: GreatHorn.Message.quarReleased
      type: Unknown
    - contextPath: GreatHorn.Message.authenticationResults
      type: String
    - contextPath: GreatHorn.Message.quarantined
      type: Unknown
    - contextPath: GreatHorn.Message.flag
      type: Number
    - contextPath: GreatHorn.Message.homographScore
      type: Number
    - contextPath: GreatHorn.Message.remediation
      type: Unknown
    - contextPath: GreatHorn.Message.owlScore
      type: Number
    - contextPath: GreatHorn.Message.quarReleaseRequested
      type: Unknown
    - contextPath: GreatHorn.Message.anomalyScore
      type: Number
    - contextPath: GreatHorn.Message.quarExpired
      type: Unknown
    - contextPath: GreatHorn.Message.displayName
      type: String
    - contextPath: GreatHorn.Message.country
      type: String
    - contextPath: GreatHorn.Message.region
      type: String
    - contextPath: GreatHorn.Message.headers.received-spf
      type: String
    - contextPath: GreatHorn.Message.headers.return-path
      type: String
    - contextPath: GreatHorn.Message.headers.x-eoptenantattributedmessage
      type: String
    - contextPath: GreatHorn.Message.headers.x-csa-complaints
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-exchange-crosstenant-authsource
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-exchange-processed-by-bccfoldering
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-exchange-organization-messagedirectionality
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-exchange-organization-expirationstarttimereason
      type: String
    - contextPath: GreatHorn.Message.headers.subject
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-exchange-organization-expirationstarttime
      type: String
    - contextPath: GreatHorn.Message.headers.list-id
      type: String
    - contextPath: GreatHorn.Message.headers.from
      type: String
    - contextPath: GreatHorn.Message.headers.to
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-office365-filtering-correlation-id
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-exchange-transport-endtoendlatency
      type: Date
    - contextPath: GreatHorn.Message.headers.x-ms-exchange-organization-expirationintervalreason
      type: String
    - contextPath: GreatHorn.Message.headers.list-unsubscribe
      type: String
    - contextPath: GreatHorn.Message.headers.mime-version
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-exchange-organization-scl
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-oob-tlc-oobclassifiers
      type: String
    - contextPath: GreatHorn.Message.headers.authentication-results
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-exchange-organization-authas
      type: String
    - contextPath: GreatHorn.Message.headers.x-microsoft-antispam-mailbox-delivery
      type: String
    - contextPath: GreatHorn.Message.headers.x-microsoft-antispam
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-traffic  typediagnostic
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-exchange-transport-crosstenantheadersstamped
      type: String
    - contextPath: GreatHorn.Message.headers.dkim-signature
      type: String
    - contextPath: GreatHorn.Message.headers.x-sfmc-stack
      type: String
    - contextPath: GreatHorn.Message.headers.date
      type: String
    - contextPath: GreatHorn.Message.headers.reply-to
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-exchange-organization-network-message-id
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-exchange-organization-authsource
      type: String
    - contextPath: GreatHorn.Message.headers.received
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-exchange-crosstenant-originalarrivaltime
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-publictraffic  type
      type: String
    - contextPath: GreatHorn.Message.headers.sender
      type: String
    - contextPath: GreatHorn.Message.headers.x-job
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-exchange-crosstenant-id
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-exchange-organization-expirationinterval
      type: String
    - contextPath: GreatHorn.Message.headers.x-eopattributedmessage
      type: String
    - contextPath: GreatHorn.Message.headers.x-microsoft-antispam-message-info
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-exchange-crosstenant-authas
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-exchange-crosstenant-fromentityheader
      type: String
    - contextPath: GreatHorn.Message.headers.x-ms-exchange-crosstenant-network-message-id
      type: String
    - contextPath: GreatHorn.Message.headers.x-forefront-antispam-report
      type: String
    - contextPath: GreatHorn.Message.headers.message-id
      type: String
    - contextPath: GreatHorn.Message.headers.content-  type
      type: String
    - contextPath: GreatHorn.Message.messageId
      type: String
    - contextPath: GreatHorn.Message.authScore
      type: Number
    - contextPath: GreatHorn.Message.headers.x-msfbl
      type: String
    - contextPath: GreatHorn.Message.headers.content-transfer-encoding
      type: String
    - contextPath: GreatHorn.Message.headers.precedence
      type: Unknown
    - contextPath: GreatHorn.Message.headers.arc-seal
      type: Unknown
    - contextPath: GreatHorn.Message.headers.arc-authentication-results
      type: Unknown
    - contextPath: GreatHorn.Message.headers.arc-message-signature
      type: Unknown
    - contextPath: GreatHorn.Message.headers.x-received
      type: Unknown
    - contextPath: GreatHorn.Message.headers.to
      type: Unknown
    - contextPath: GreatHorn.Message.headers.x-unsubscribe-web
      type: Unknown
    - contextPath: GreatHorn.Message.headers.x-mailer
      type: Unknown
    - contextPath: GreatHorn.Message.headers.x-info
      type: Unknown
    - contextPath: GreatHorn.Message.headers.delivered-to
      type: Unknown
    - contextPath: GreatHorn.Message.headers.mime-version
      type: Unknown
    - contextPath: GreatHorn.Message.headers.x-tm-id
      type: Unknown
    - contextPath: GreatHorn.Message.headers.x-rpcampaign
      type: Unknown
    - contextPath: GreatHorn.Message.headers.x-google-smtp-source
      type: Unknown
    - contextPath: GreatHorn.Message.headers.content-type
      type: Unknown
    - contextPath: GreatHorn.SearchCount
      type: Number
  - arguments:
    - auto: PREDEFINED
      default: false
      description: The action to take on the given message
      isArray: false
      name: action
      predefined:
      - archive
      - banner
      - delete
      - label
      - move
      - quarantine
      - delete
      - removeattachments
      - review
      - trash
      required: true
      secret: false
    - default: false
      description: The GreatHorn event ID
      isArray: false
      name: eventId
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: 'True'
      description: If true, the banner will include a button enabling the end-user
        to remove the banner. Default is True.
      isArray: false
      name: hasButton
      predefined:
      - 'True'
      - 'False'
      required: false
      secret: false
    - default: false
      description: The text to display in the email's banner.
      isArray: false
      name: message
      required: false
      secret: false
    - default: false
      description: The name of the label to add. If the label name does not exist,
        it will be created.
      isArray: false
      name: label
      required: false
      secret: false
    - default: false
      description: The target location in the user's mailbox. If the location does
        not exist, it will be created.
      isArray: false
      name: location
      required: false
      secret: false
    deprecated: false
    execution: false
    name: gh-remediate-message
    outputs:
    - contextPath: GreatHorn.Remediation.action
      type: String
    - contextPath: GreatHorn.Remediation.eventId
      type: String
    - contextPath: GreatHorn.Remediation.reason
      type: String
    - contextPath: GreatHorn.Remediation.success
      type: Number
  - arguments:
    - auto: PREDEFINED
      default: false
      isArray: false
      name: action
      predefined:
      - banner
      - quarantinerequest
      - quarantinerelease
      - quarantinedeny
      - removeattachments
      - review
      required: true
      secret: false
    - default: false
      isArray: false
      name: eventId
      required: true
      secret: false
    deprecated: false
    execution: false
    name: gh-revert-remediate-message
    outputs:
    - contextPath: GreatHorn.Remediation.action
      type: String
    - contextPath: GreatHorn.Remediation.eventId
      type: String
    - contextPath: GreatHorn.Remediation.reason
      type: String
    - contextPath: GreatHorn.Remediation.success
      type: Number
  - arguments:
    - default: false
      isArray: false
      name: policyid
      required: false
      secret: false
    deprecated: false
    execution: false
    name: gh-get-policy
    outputs:
    - contextPath: GreatHorn.Policy.name
      type: String
    - contextPath: GreatHorn.Policy.enabled
      type: Number
    - contextPath: GreatHorn.Policy.config
      type: String
    - contextPath: GreatHorn.Policy.config.opt
      type: String
    - contextPath: GreatHorn.Policy.config.values
      type: String
    - contextPath: GreatHorn.Policy.config.type
      type: String
    - contextPath: GreatHorn.Policy.config.header
      type: String
    - contextPath: GreatHorn.Policy.config.min
      type: Number
    - contextPath: GreatHorn.Policy.config.value
      type: String
    - contextPath: GreatHorn.Policy.id
      type: Number
    - contextPath: GreatHorn.Policy.description
      type: String
  - arguments:
    - default: false
      isArray: false
      name: policiyid
      required: true
      secret: false
    - default: false
      isArray: false
      name: policyjson
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      isArray: false
      name: updatemethod
      predefined:
      - put
      - patch
      required: true
      secret: false
    deprecated: false
    execution: false
    name: gh-set-policy
    outputs:
    - contextPath: GreatHorn.Policy.id
      type: Number
    - contextPath: GreatHorn.Remediation.success
      type: String
  dockerimage: demisto/python3:3.8.3.9324
  feed: false
  isfetch: true
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  subtype: python3
  type: python
